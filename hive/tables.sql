create table transaction(uniqueid STRING,transactionid STRING,transactiontypeid STRING,businessdate STRING,iscancelled STRING,adjustmentname STRING,adjustmenttype STRING,accountid STRING,instrumentid STRING,tradedate STRING,settledate STRING,actualsettledate STRING,quantity STRING,originalface STRING,factor STRING,localprice STRING,bookprice STRING,localamount STRING,bookamount STRING,localnetamount STRING,nettradeflag STRING,booknetamount STRING,netsettlementamount STRING,localgain STRING,bookgain STRING,localcurrency STRING,bookcurrency STRING,tradecurrency STRING,localcost STRING,bookcost STRING,localcashflow STRING,bookcashflow STRING,commission STRING,secfees STRING,expenses STRING,marketvaluebook STRING,marketvaluelocal STRING,marketpricelocal STRING,marketpricebook STRING,fxrate STRING,taxamount STRING,miscexpenseamount STRING,brokerid STRING,broker STRING,trader STRING,comments STRING,auditkey STRING,realizedgainlossshortterm STRING,realizedgainlosslongterm STRING,accruedinterestlocal STRING,accruedinterestbook STRING,taxlotdate STRING,entryuser STRING,entrydate STRING,addedby STRING,addeddate STRING,updatedby STRING,updateddate STRING,ishiddenexternal STRING,oldshares STRING,newshares STRING,oldprice STRING,newprice STRING,reasoncode STRING,basketid STRING,settlecurrency STRING,isdefault STRING,reinvestflag STRING,reinvestdate STRING,pershareamount STRING,accountdate STRING,taxrate STRING,strategycode STRING,genericinstrumentid STRING,fees STRING,tradeid STRING,accruedinterestsettlement STRING,outstandingamountlocal STRING,outstandingamountbook STRING,isdistressed STRING,pricecapitalized STRING,issettled STRING,virtusid STRING,bmsassetid STRING,fwdtransid STRING,executiondate STRING,isclientflow STRING,isclientfee STRING,notionalbook STRING,transactionsubtypeid STRING,underlyingaccountid STRING,transferid STRING,transfeeinportfolioccy STRING,transfeeininstrccy STRING,trademodifeddate STRING,instrumenttradeamount STRING,orderid STRING,previoustradeid STRING,commissionlocal STRING,additionalsectype STRING,counterparty STRING,tradestatus STRING,executiondatetime STRING,exchangeid STRING,transactiontype STRING,transactionsubtype STRING,timeid STRING,sourcename STRING,instrumentticker STRING,instrumentric STRING,instrumentsedol STRING,instrumentcusip STRING,instrumentisin STRING,typetier1name STRING,typetier2name STRING,typetier3name STRING,crdaisourceid STRING,ssncsourceid STRING,citisourceid STRING,bmssourceid STRING,bnpsourceid STRING,crdsmgsourceid STRING,citcosourceid STRING,seisourceid STRING,palsourceid STRING,jpmcsourceid STRING,crimssourceid STRING,carmignacsourceid STRING,gicscode STRING,gicssector STRING,gicsindustrygroup STRING,gicsindustry STRING,gicssubindustry STRING,dataprovidername STRING,businessunitname STRING,portfolioname STRING,accountname STRING,accountcurrencyid STRING,managername STRING,accountcustodianname STRING) CLUSTERED BY(uniqueid) INTO 1 BUCKETS
 STORED AS ORC TBLPROPERTIES("PRIMARY KEY"="uniqueid", "transactional"="true");

create table position(uniqueid STRING,rownum STRING,accountid STRING,instrumentid STRING,timeid STRING,netquantity STRING,marketpricelocal STRING,marketpricebook STRING,marketvaluebook STRING,marketvaluelocal STRING,localcurrency STRING,bookcurrency STRING,costlocal STRING,costbook STRING,accruedinterestbook STRING,accruedinterestlocal STRING,unitcostlocal STRING,unitcostbook STRING,percentassets STRING,couponamount STRING,dividend STRING,totalpl STRING,longshortposition STRING,currentvaluebook STRING,unsupervisedflag STRING,yieldoncost STRING,yieldtomaturity STRING,yieldtocall STRING,yieldtoworst STRING,estimatedannualincome STRING,accrualdays STRING,originalface STRING,currentface STRING,factor STRING,netshareposition STRING,sharesonloan STRING,exchangerate STRING,modifiedduration STRING,macaulayduration STRING,modifieddurationtoworst STRING,macaulaydurationtoworst STRING,businessdate STRING,unrealizedfxgainloss STRING,unrealizedpricegainloss STRING,realizedfxgainloss STRING,realizedpricegainloss STRING,mtdunrealizedfxgainloss STRING,mtdunrealizedpricegainloss STRING,mtdrealizedfxgainloss STRING,mtdrealizedpricegainloss STRING,mtddividend STRING,mtdcoupon STRING,mtdtotalpl STRING,ytdunrealizedfxgainloss STRING,ytdunrealizedpricegainloss STRING,ytdrealizedfxgainloss STRING,ytdrealizedpricegainloss STRING,ytddividend STRING,ytdcoupon STRING,ytdtotalpl STRING,realizedgainlossshortterm STRING,realizedgainlosslongterm STRING,netquantitysettle STRING,marketvaluebooksettle STRING,marketvaluelocalsettle STRING,costlocalsettle STRING,costbooksettle STRING,accruedinterestbooksettle STRING,accruedinterestlocalsettle STRING,unrealizedfxgainlosssettle STRING,unrealizedpricegainlosssettle STRING,realizedfxgainlosssettle STRING,realizedpricegainlosssettle STRING,percentassetssettle STRING,couponamountsettle STRING,dividendsettle STRING,totalplsettle STRING,currentvaluebooksettle STRING,estimatedannualincomesettle STRING,mtdunrealizedfxgainlosssettle STRING,mtdunrealizedpricegainlosssettle STRING,mtdrealizedfxgainlosssettle STRING,mtdrealizedpricegainlosssettle STRING,mtddividendsettle STRING,mtdcouponsettle STRING,mtdtotalplsettle STRING,ytdunrealizedfxgainlosssettle STRING,ytdunrealizedpricegainlosssettle STRING,ytdrealizedfxgainlosssettle STRING,ytdrealizedpricegainlosssettle STRING,ytddividendsettle STRING,ytdcouponsettle STRING,ytdtotalplsettle STRING,realizedgainlossshorttermsettle STRING,realizedgainlosslongtermsettle STRING,originalfacesettle STRING,netsharepositionsettle STRING,sharesonloansettle STRING,mtdrealizedpricegainlossshortterm STRING,mtdrealizedpricegainlosslongterm STRING,ytdrealizedpricegainlossshortterm STRING,ytdrealizedpricegainlosslongterm STRING,dataproviderid STRING,addedby STRING,addeddate STRING,updatedby STRING,updateddate STRING,auditkey STRING,mtdrealizedpricegainlossshorttermsettle STRING,mtdrealizedpricegainlosslongtermsettle STRING,qtdrealizedpricegainlossshorttermsettle STRING,qtdrealizedpricegainlosslongtermsettle STRING,ytdrealizedpricegainlossshorttermsettle STRING,ytdrealizedpricegainlosslongtermsettle STRING,qtdrealizedpricegainlossshortterm STRING,qtdrealizedpricegainlosslongterm STRING,exposurelocal STRING,exposurebook STRING,basketid STRING,fwdtransid STRING,pledgedreasoncode STRING,financingaccrual STRING,totaltransferamount STRING,strategycode STRING,dtdtotalpl STRING,unrealizedpricegainlosslocal STRING,dtdaccruedinterestlocal STRING,dtdaccruedinterestbook STRING,creditfacilityfunded STRING,creditfacilityunfunded STRING,paramount STRING,outstandingamount STRING,loanamount STRING,virtusid STRING,swapinstrumentid STRING,bmsassetid STRING,maturitydate STRING,moodysindustry STRING,spindustry STRING,snprecoveryratingnumerical STRING,warf STRING,snpassetrecovery STRING,moodysassetrecovery STRING,swapeffectivedate STRING,underlyingaccountid STRING,lastsubscriptiondate STRING,positionclosingmarketvalue STRING,positionpricedate STRING,mvoftdposition STRING,localcustommv STRING,bookcustommv STRING,costnotional STRING,fed_requirement STRING,pershing_margin_requirement STRING,cashshortmargin STRING,cashphys STRING,paymentccy STRING,paymentdate STRING,swapnotional STRING,swapcostnotional STRING,fromcurrency STRING,tocurrency STRING,swaporiginaltradedate STRING,swapdataproviderinstrumentid STRING,custodianaccount STRING,crdfwdtransid STRING,businessunitname STRING,cashposition STRING,positiontype STRING,dataprovidername STRING,sourcename STRING,ndfflag STRING,fixingdate STRING,totalpllocal STRING,amortizedcost STRING,sodlocatecost STRING,rdsextinstrumentid STRING,rdssourcename STRING,rdsaccountid STRING,booktousdexchangerate STRING,contractsize STRING,custodianname STRING,dailygrosstotalreturnbook STRING,dailygrosstotalreturnlocal STRING,dailynetrealizedpl STRING,dailyploverwrite STRING,dailypricereturnbook STRING,dailypricereturnlocal STRING,dailyrealizedpl STRING,dailyunrealizedpl STRING,rdsfromcurrency STRING,interestratereturngross STRING,interestratereturngrossdtd STRING,interestratereturnweighted STRING,issmpfund STRING,localendmarketprice STRING,ltdrealized STRING,ltdrealizedpl STRING,ltdtotalpl STRING,ltdunrealized STRING,ltdunrealizedpl STRING,ltdunrealizedplsettled STRING,ltdunrealizedpltraded STRING,marketexposuregross STRING,mtdrealized STRING,mtdrealizedpl STRING,mtdtotalfxpl STRING,mtdunrealized STRING,mtdunrealizedpl STRING,multiplier STRING,notional STRING,notionalbook STRING,openingmarketprice STRING,openingmarketvalue STRING,sourcepositionid STRING,strategyname STRING,subentity STRING,substrategyname STRING,unrealizedpl STRING,volumeturnover STRING,weight STRING,ytdaccruedinterest STRING,ytdrealized STRING,ytdrealizedfx STRING,ytdrealizedpl STRING,ytdunrealized STRING,ytdunrealizedfx STRING,ytdunrealizedpl STRING,rdsbookcurrency STRING,rdsbasketid STRING,rdsinstrumentid STRING,instrumentticker STRING,instrumentric STRING,instrumentsedol STRING,instrumentcusip STRING,instrumentisin STRING,typetier1name STRING,typetier2name STRING,typetier3name STRING,crdaisourceid STRING,ssncsourceid STRING,citisourceid STRING,bmssourceid STRING,bnpsourceid STRING,crdsmgsourceid STRING,citcosourceid STRING,seisourceid STRING,palsourceid STRING,jpmcsourceid STRING,crimssourceid STRING,carmignacsourceid STRING,gicscode STRING,gicssector STRING,gicsindustrygroup STRING,gicsindustry STRING,gicssubindustry STRING,portfolioname STRING,accountname STRING,accountcurrencyid STRING,managername STRING,accountcustodianname STRING) CLUSTERED BY(uniqueid) INTO 1 BUCKETS STORED AS ORC TBLPROPERTIES("PRIMARY KEY"="uniqueid", "transactional"="true");

create table instrument(instrumentid STRING,instrumentkey STRING,issuerid STRING,accrualstartdate STRING,addedby STRING,addeddate STRING,altsticker STRING,cashsettle STRING,contractdate STRING,convexity STRING,currency STRING,cvrratio STRING,dataprovidername STRING,crdsmgsourceid STRING,citcosourceid STRING,seisourceid STRING,palsourceid STRING,defaultdate STRING,defaultflag STRING,deliverdate STRING,fabsfirstpaydate STRING,fabslastfactor STRING,fabslastfactordate STRING,fcouponbasesecurity STRING,fcouponpaymentdate STRING,fcouponprevpaymentdate STRING,financing STRING,financingfirstresetdate STRING,financingtype STRING,fiprincipalonly STRING,firstresetdate STRING,fixedfee STRING,freefloatpercent STRING,glosscode STRING,gmagfirmcode STRING,gobalindustrycode STRING,ind_ann_div STRING,initialmargin STRING,initialmargincurrency STRING,initialmargintype STRING,instrumentbb STRING,ismezzanine STRING,registrationtype STRING,adtv10day STRING,adtv180day STRING,adtv30day STRING,adtv90day STRING,altmintax STRING,amtoutstanding STRING,announcementdate STRING,askprice STRING,assetsubtype STRING,averagelife STRING,bankdeal STRING,bankdealagentbank STRING,bankdealprimarysponsor STRING,bbgindustrygroup STRING,bbgindustrysector STRING,bbgindustrysubgroup STRING,bidprice STRING,bloombergid STRING,businessdayconv STRING,businessdays STRING,call STRING,clientindustryclassification STRING,collateraltype STRING,commitmentamount STRING,commoditylinked STRING,compoundinterestflag STRING,contractsize STRING,countryexposure STRING,countryquotation STRING,countryregister STRING,coupondaycount STRING,couponfrequncy STRING,couponlastdate STRING,couponrate STRING,coupontotalrate STRING,coupontype STRING,csfbindustry STRING,currencyissuedcapital STRING,currencyquotation STRING,dailytradingvolume STRING,crdaisourceid STRING,ssncsourceid STRING,citisourceid STRING,bmssourceid STRING,bnpsourceid STRING,dealtype STRING,deltafactor STRING,duration STRING,durationmodified STRING,effectivedate STRING,effectivematuritydate STRING,equityresetdate STRING,equitytype STRING,exercisetype STRING,expirydate STRING,fabscollateraltype STRING,facilityglobalamount STRING,fcouponcap STRING,fcouponfloor STRING,fcouponnextresetdate STRING,fcouponresetfrequency STRING,fedtaxflag STRING,financingaccrualmethod STRING,firstsettledate STRING,floatingspreadcap STRING,floatingspreadcapcurrent STRING,floatingspreadfloor STRING,floatingspreadfloorcurrent STRING,fundassetclassfocus STRING,fundgeofocus STRING,funducits STRING,instrumentcusip STRING,instrumentisin STRING,instrumentric STRING,instrumentsedol STRING,instrumentticker STRING,instrumenttypetier1 STRING,instrumenttypetier2 STRING,instrumenttypetier3 STRING,instrumentvaloran STRING,interestaccrualdate STRING,inverseratemarker STRING,is144aflag STRING,is144aregistrationrights STRING,isbridgesecurity STRING,isconvertible STRING,iscovenantlite STRING,iscreditdefaultswap STRING,isdefaulted STRING,isdelayeddraw STRING,isdip STRING,isemergingmarket STRING,iseompaying STRING,isguaranteed STRING,isleveraged STRING,ismulticurrencyloan STRING,isrefunded STRING,isrevolver STRING,issfo STRING,issuecalctype STRING,issuedate STRING,issuedateddate STRING,issuedcapital STRING,issuedshare STRING,issuefirstcoupondate STRING,issueprice STRING,issueranalyst STRING,issuercountryofdomicile STRING,issuercurrencycode STRING,issuerdebtamount STRING,issuerfitchsic STRING,issuerindustry STRING,issuersharesout STRING,issuertotalvotingsharesvalue STRING,issueseries STRING,issuestate STRING,issynthetic STRING,lastdivpaydate STRING,lastprice STRING,leadunderwritername STRING,leverageratio STRING,liborspread STRING,lientype STRING,lin STRING,loantype STRING,loanxid STRING,margin STRING,marketid STRING,marketissue STRING,maturitydate STRING,maturitytype STRING,mdeindicator STRING,mdsname STRING,merrilllynchhighyieldindustry STRING,merrilllynchindustrylevel3 STRING,moodysindustry STRING,name STRING,nextdivexdate STRING,nominalamount STRING,openinterest STRING,originalamt STRING,originalspread STRING,paladynesecidentifier STRING,paymentccy STRING,pfssectype STRING,pikrate STRING,pikbegindate STRING,pikpercentage STRING,pricedate STRING,pricemultiplier STRING,pricesource STRING,pricingreference STRING,primaryexchangeid STRING,primaryexchangename STRING,primaryspreadtype STRING,principalprotection STRING,privateplacement STRING,put STRING,ratetype STRING,recvcoupontype STRING,refxzero STRING,regs STRING,instrumentrootric STRING,roundlot STRING,secondarycoupondaycount STRING,secondaryspread STRING,secondaryspreadtype STRING,secrestriction STRING,sectortier1customer1 STRING,sectortier2customer1 STRING,sectortier3customer1 STRING,sectortier4customer1 STRING,settlementcalendar STRING,sharesout STRING,sharesperadr STRING,sodprice STRING,spindustry STRING,startdate STRING,status STRING,strikeprice STRING,swapearlytermationflag STRING,swapeffectivedate STRING,swapenddateschedule STRING,swapliborresetdateschedule STRING,swappaydateschedule STRING,swapportfolioid STRING,swappriceresetfrequency STRING,swapresetdateschedule STRING,swapstartdateschedule STRING,term STRING,tickvalue STRING,trademultiplier STRING,underlylingbmsassetid STRING,underlyinginstrumentid STRING,underlyinginstrumentidentifier STRING,underregulation STRING,volumeweightedavgprice STRING,votingrights STRING,wam STRING,whenissued STRING,yieldtomaturity STRING,yieldtoworst STRING,countryincorporation STRING,seniortytype STRING,jpmcsourceid STRING,effectiveduration STRING,opicssourceid STRING,trademultiplierreuters STRING,contractsizereuters STRING,fireflyrootric STRING,fireflyexpirydate STRING,fireflytradingcal STRING,ntpacode STRING,futurescategory STRING,crimssourceid STRING,carmignacsourceid STRING,mdscalendarname STRING,alpha STRING,assetprice STRING,bbgglobal STRING,beamshybridid STRING,beta STRING,businessdayoffset STRING,comments STRING,continuouslycallable STRING,country STRING,countrycustomer STRING,couponcurrency STRING,couponfirsttype STRING,couponpayinkind STRING,creditticker STRING,crosscurrency STRING,csheldfund STRING,dividedfreqid STRING,eps STRING,eqy_init_po_date STRING,fabsavgcoupon STRING,fabscprliferate STRING,fabsdealname STRING,fabsdelaydays STRING,fabslifecap STRING,fabslifefloor STRING,fabsorigmaturityterm STRING,fabspaymenttype STRING,fabspoolnum STRING,fabspsaliferate STRING,fabstba STRING,fabstotaldealamt STRING,factored STRING,fcouponnextresetdatebbg STRING,fcouponpaymentdatebbg STRING,fcouponratebbg STRING,fcouponrateeffectivedate STRING,fcouponresetformula STRING,fcouponstepup STRING,fiaccaccuralwithinterest STRING,fiaccrualbusinessday STRING,fiaccrualsuppress STRING,fiaccrualthroughsettle STRING,ficouponcalendar STRING,fidelaydays STRING,figenerateschedule STRING,fiindespriceonissue STRING,fiindexadjust STRING,fiintersteonly STRING,fiintervaldays STRING,finalvaluationdate STRING,financingside STRING,floatrateresetlagdays STRING,floatratespreadbps STRING,fwdcommodity STRING,fxdelta STRING,incomecurrency STRING,instrumenttypetier4 STRING,thirteenf STRING,thirteengeligible STRING,pershingsourceid STRING,investmentcode STRING,investmenttype STRING,irdelta STRING,isdividend STRING,ishardborrow STRING,isnetrule STRING,isonfuture STRING,issuepar STRING,issuesettledate STRING,issuestatus STRING,issuseannouncedate STRING,istermloan STRING,lastsplitdate STRING,lowerbarrier STRING,marginbbg STRING,mediumtermnotes STRING,mincallnotificationdays STRING,netrule STRING,nextcoupondate STRING,nextdivamount STRING,nextdivdate STRING,nonconduit STRING,notional STRING,opt_delta STRING,opt_gamma STRING,opt_rho STRING,opt_theta STRING,opt_vega STRING,origdiscount STRING,origexchangeid STRING,originalcurrency STRING,outstandingdate STRING,paladynechangedate STRING,paladynecreatedate STRING,paladyneintradayprice STRING,paladyneupdateby STRING,paltradingstatus STRING,partlypaid STRING,payfrequency STRING,perpetual STRING,pipe STRING,prefered STRING,prerefundeddate STRING,prerefundedprice STRING,priceclean STRING,pricecurrency STRING,pricerange STRING,pricingfrequency STRING,primecashidcpricingflag STRING,rebateamt STRING,recoveryrate STRING,recvcountry STRING,recvcoupondaycount STRING,recvcouponfrequency STRING,recvcouponrate STRING,recvcurrency STRING,recvfcouponbasesecurity STRING,recvfinancingside STRING,recvfloatratespreadbps STRING,recvnotional STRING,redemvalue STRING,redid STRING,rfc STRING,riskcurrency STRING,riskfactor STRING,settelmentdays STRING,sharesoutdate STRING,sink STRING,symbol STRING,tenor STRING,totalamount STRING,tradecurrency STRING,triggervalue STRING,ultimateissuer STRING,ultimateissuercode STRING,underlyingaccountid STRING,underlylingvirtusid STRING,virtusassetdescription STRING,virtusassettrancheid STRING,virtusbankdealagentbankid STRING,virtusbankdealid STRING,virtusbankdealprimarysponsorid STRING,virtusid STRING,virtusissuerid STRING,virtusissuername STRING,virtusleadunderwriterid STRING,volatility STRING,debttype STRING,strike STRING,basket STRING,minfeeflag STRING,breakclauseind STRING,gicscode STRING,gicssector STRING,gicsindustrygroup STRING,gicsindustry STRING,gicssubindustry STRING,typetier1name STRING,typetier2name STRING,typetier3name STRING,sourcename STRING,guarantorid STRING,currentglobalfacilityamt STRING,macaulayduration STRING,sscissuername STRING,sscissuerid STRING,assetdescription STRING,coinvestment STRING,taxablemunicipalsecurities STRING,bbginversefloaters STRING,bbgmortgagetranchetype STRING,bbgloantranchesize STRING,bbgloandealamount STRING,bbgloanpurposedescription STRING,bbgcouponfrequency STRING,bbgloancurrentmargin STRING,bbgliborfloor STRING,bbgsprecoveryrating STRING,bbgmoodyoutlook STRING,bbgmoodywatch STRING,principalplaceofbusiness STRING,ispublicequity STRING,isfinancialsponsor STRING,financialsponsor2 STRING,restructureclassification STRING,ismaintenancecovenants STRING,isparipassudebt STRING,iscrossdefaultprovision STRING,isnonclocovlite STRING,isclocovlite STRING,leasetransactioneurope STRING,ispik STRING,toggleoption STRING,moodysindustryclo20 STRING,sandpindustryclo20 STRING,sandpindustryclo2016 STRING,coborrower STRING,isfungibleifincremental STRING,oid STRING,iscspartytoca STRING,underwritersorarrangers STRING,amendmentdate STRING,secondaryanalyst STRING,analystindustry STRING,sicindustry STRING,totalvotingsharevalue STRING,specialsituationscompany STRING,cashequivalent STRING,yieldtocallflag STRING,bearerindicator STRING,bbgcovenantlite STRING,bbgbidworkoutdate STRING,bbgbidyieldtoconvention STRING,spreadtoworst STRING,macaulaydurationask STRING,modifieddurationask STRING,effectivedurationask STRING,iscsanunderwriter STRING,couponfrequencytext STRING,fcouponfrequencytext STRING,coupontypetext STRING,dataproviderid STRING) CLUSTERED BY(instrumentid) INTO 1 BUCKETS STORED AS ORC TBLPROPERTIES("PRIMARY KEY"="instrumentid", "transactional"="true");