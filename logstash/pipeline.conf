input {
  file {
    path => "/usr/share/logstash/data/Transaction/*.csv"
    start_position => "beginning"
    sincedb_path => "/usr/share/logstash/data/transaction.sincedb"
    type => "transaction"
  }
  file {
    path => "/usr/share/logstash/data/Instrument/*.csv"
    start_position => "beginning"
    sincedb_path => "/usr/share/logstash/data/instrument.sincedb"
    type => "instrument"
  }
  file {
    path => "/usr/share/logstash/data/Position/*.csv"
    start_position => "beginning"
    sincedb_path => "/usr/share/logstash/data/position.sincedb"
    type => "position"
  }
}

filter {
  if [type] == "transaction" {
    csv {
      skip_header => true
      columns => [
        "UniqueId",
        "TransactionID",
        "TransactionTypeID",
        "BusinessDate",
        "IsCancelled",
        "AdjustmentName",
        "AdjustmentType",
        "AccountId",
        "InstrumentID",
        "TradeDate",
        "SettleDate",
        "ActualSettleDate",
        "Quantity",
        "OriginalFace",
        "Factor",
        "LocalPrice",
        "BookPrice",
        "LocalAmount",
        "BookAmount",
        "LocalNetAmount",
        "NetTradeFlag",
        "BookNetAmount",
        "NetSettlementAmount",
        "LocalGain",
        "BookGain",
        "LocalCurrency",
        "BookCurrency",
        "TradeCurrency",
        "LocalCost",
        "BookCost",
        "LocalCashFlow",
        "BookCashFlow",
        "Commission",
        "SECFees",
        "Expenses",
        "MarketValueBook",
        "MarketValueLocal",
        "MarketPriceLocal",
        "MarketPriceBook",
        "FXRate",
        "TaxAmount",
        "MiscExpenseAmount",
        "BrokerID",
        "Broker",
        "Trader",
        "Comments",
        "AuditKey",
        "RealizedGainLossShortTerm",
        "RealizedGainLossLongTerm",
        "AccruedInterestLocal",
        "AccruedInterestBook",
        "TaxLotDate",
        "EntryUser",
        "EntryDate",
        "AddedBy",
        "AddedDate",
        "UpdatedBy",
        "UpdatedDate",
        "IsHiddenExternal",
        "OldShares",
        "NewShares",
        "OldPrice",
        "NewPrice",
        "ReasonCode",
        "BasketID",
        "SettleCurrency",
        "IsDefault",
        "ReInvestFlag",
        "ReInvestDate",
        "PerShareAmount",
        "AccountDate",
        "TaxRate",
        "StrategyCode",
        "GenericInstrumentID",
        "Fees",
        "TradeID",
        "AccruedInterestSettlement",
        "OutstandingAmountLocal",
        "OutstandingAmountBook",
        "IsDistressed",
        "PriceCapitalized",
        "IsSettled",
        "VirtusID",
        "BMSAssetID",
        "FwdTransID",
        "ExecutionDate",
        "IsClientFlow",
        "IsClientFee",
        "NotionalBook",
        "TransactionSubTypeID",
        "UnderlyingAccountID",
        "TransferID",
        "TransFeeInPortfolioCCY",
        "TransFeeInInstrCCY",
        "TradeModifedDate",
        "InstrumentTradeAmount",
        "OrderID",
        "PreviousTradeID",
        "CommissionLocal",
        "AdditionalSecType",
        "Counterparty",
        "TradeStatus",
        "ExecutionDateTime",
        "ExchangeId",
        "TransactionType",
        "TransactionSubType",
        "TimeID",
        "SourceName",
        "InstrumentTicker",
        "InstrumentRIC",
        "InstrumentSedol",
        "InstrumentCusip",
        "InstrumentIsin",
        "TypeTier1Name",
        "TypeTier2Name",
        "TypeTier3Name",
        "CRDAISourceID",
        "SSNCSourceID",
        "CitiSourceID",
        "BMSSourceID",
        "BNPSourceID",
        "CRDSMGSourceID",
        "CitcoSourceID",
        "SEISourceID",
        "PalSourceID",
        "JPMCSourceID",
        "CRIMSSourceID",
        "CarmignacSourceID",
        "GICSCode",
        "GICSSector",
        "GICSIndustryGroup",
        "GICSIndustry",
        "GICSSubIndustry",
        "DataProviderName",
        "BusinessUnitName",
        "PortfolioName",
        "AccountName",
        "AccountCurrencyId",
        "ManagerName",
        "AccountCustodianName"
      ]
    }

    date {
      match => [ "TradeDate", "ISO8601" ]
      target => "DiscriminatorDate"
    }

    mutate {
      add_field => {
        "url" => "/Transaction/%{UniqueId}"
      }
    }
  }

  if [type] == "instrument" {
    csv {
      skip_header => true
      columns => [
        "InstrumentId",
        "InstrumentKey",
        "IssuerID",
        "AccrualStartDate",
        "AddedBy",
        "AddedDate",
        "AltsTicker",
        "CashSettle",
        "ContractDate",
        "Convexity",
        "Currency",
        "CvrRatio",
        "DataProviderName",
        "CRDSMGSourceID",
        "CitcoSourceID",
        "SEISourceID",
        "PalSourceID",
        "DefaultDate",
        "DefaultFlag",
        "DeliverDate",
        "FAbsFirstPayDate",
        "FAbsLastFactor",
        "FAbsLastFactorDate",
        "FCouponBaseSecurity",
        "FCouponPaymentDate",
        "FCouponPrevPaymentDate",
        "Financing",
        "FinancingFirstResetDate",
        "FinancingType",
        "FIPrincipalOnly",
        "FirstResetDate",
        "FixedFee",
        "FreeFloatPercent",
        "GlossCode",
        "GMAGFIRMCode",
        "GobalIndustryCode",
        "Ind_ann_div",
        "InitialMargin",
        "InitialMarginCurrency",
        "InitialMarginType",
        "InstrumentBB",
        "IsMezzanine",
        "RegistrationType",
        "ADTV10DAY",
        "ADTV180Day",
        "ADTV30Day",
        "ADTV90Day",
        "AltminTax",
        "AmtOutstanding",
        "AnnouncementDate",
        "AskPrice",
        "AssetSubType",
        "AverageLife",
        "BankDeal",
        "BankDealAgentBank",
        "BankDealPrimarySponsor",
        "BBGIndustryGroup",
        "BBGIndustrySector",
        "BBGIndustrySubgroup",
        "BidPrice",
        "BloombergID",
        "BusinessDayConv",
        "BusinessDays",
        "Call",
        "ClientIndustryClassification",
        "CollateralType",
        "CommitmentAmount",
        "CommodityLinked",
        "CompoundInterestFlag",
        "ContractSize",
        "CountryExposure",
        "CountryQuotation",
        "CountryRegister",
        "CouponDayCount",
        "CouponFrequncy",
        "CouponLastDate",
        "CouponRate",
        "CouponTotalRate",
        "CouponType",
        "CSFBIndustry",
        "CurrencyIssuedCapital",
        "CurrencyQuotation",
        "DailyTradingVolume",
        "CRDAISourceID",
        "SSNCSourceID",
        "CitiSourceID",
        "BMSSourceID",
        "BNPSourceID",
        "DealType",
        "DeltaFactor",
        "Duration",
        "DurationModified",
        "EffectiveDate",
        "EffectiveMaturityDate",
        "EquityResetDate",
        "EquityType",
        "ExerciseType",
        "ExpiryDate",
        "FAbsCollateralType",
        "FacilityGlobalAmount",
        "FCouponCap",
        "FCouponFloor",
        "FCouponNextResetDate",
        "FCouponResetFrequency",
        "FEDTaxFlag",
        "FinancingAccrualMethod",
        "FirstSettleDate",
        "FloatingSpreadCap",
        "FloatingSpreadCapCurrent",
        "FloatingSpreadFloor",
        "FloatingSpreadFloorCurrent",
        "FundAssetClassFocus",
        "FundGeoFocus",
        "FundUCITS",
        "InstrumentCusip",
        "InstrumentIsin",
        "InstrumentRIC",
        "InstrumentSedol",
        "InstrumentTicker",
        "InstrumentTypeTier1",
        "InstrumentTypeTier2",
        "InstrumentTypeTier3",
        "InstrumentValoran",
        "InterestAccrualDate",
        "InverseRateMarker",
        "Is144AFlag",
        "Is144ARegistrationRights",
        "IsBridgeSecurity",
        "IsConvertible",
        "IsCovenantLite",
        "IsCreditDefaultSwap",
        "IsDefaulted",
        "IsDelayedDraw",
        "IsDip",
        "IsEmergingMarket",
        "IsEOMPaying",
        "IsGuaranteed",
        "IsLeveraged",
        "IsMultiCurrencyLoan",
        "IsRefunded",
        "IsRevolver",
        "IsSFO",
        "IssueCalcType",
        "IssueDate",
        "IssueDatedDate",
        "IssuedCapital",
        "IssuedShare",
        "IssueFirstCouponDate",
        "IssuePrice",
        "IssuerAnalyst",
        "IssuerCountryOfDomicile",
        "IssuerCurrencyCode",
        "IssuerDebtAmount",
        "IssuerFITCHSIC",
        "IssuerIndustry",
        "IssuerSharesOut",
        "IssuerTotalVotingSharesValue",
        "IssueSeries",
        "IssueState",
        "IsSynthetic",
        "LastDivPayDate",
        "LastPrice",
        "LeadUnderwriterName",
        "LeverageRatio",
        "LiborSpread",
        "LienType",
        "LIN",
        "LoanType",
        "LoanXID",
        "Margin",
        "MarketId",
        "MarketIssue",
        "MaturityDate",
        "MaturityType",
        "MDEIndicator",
        "MDSName",
        "MerrillLynchHighYieldIndustry",
        "MerrillLynchIndustryLevel3",
        "MoodysIndustry",
        "Name",
        "NextDivExDate",
        "NominalAmount",
        "OpenInterest",
        "OriginalAmt",
        "OriginalSpread",
        "PaladyneSecIdentifier",
        "PaymentCCY",
        "PFSSecType",
        "PIKRate",
        "PIKBeginDate",
        "PIKPercentage",
        "PriceDate",
        "PriceMultiplier",
        "PriceSource",
        "PricingReference",
        "PrimaryExchangeId",
        "PrimaryExchangeName",
        "PrimarySpreadType",
        "PrincipalProtection",
        "PrivatePlacement",
        "Put",
        "RateType",
        "RecvCouponType",
        "RefXZero",
        "RegS",
        "InstrumentRootRIC",
        "RoundLot",
        "SecondaryCouponDayCount",
        "SecondarySpread",
        "SecondarySpreadType",
        "SECRestriction",
        "SectorTier1Customer1",
        "SectorTier2Customer1",
        "SectorTier3Customer1",
        "SectorTier4Customer1",
        "SettlementCalendar",
        "SharesOut",
        "SharesPerADR",
        "SODPrice",
        "SPIndustry",
        "StartDate",
        "Status",
        "StrikePrice",
        "SwapEarlyTermationFlag",
        "SwapEffectiveDate",
        "SwapEndDateSchedule",
        "SwapLiborResetDateSchedule",
        "SwapPayDateSchedule",
        "SwapPortfolioId",
        "SwapPriceResetFrequency",
        "SwapResetDateSchedule",
        "SwapStartDateSchedule",
        "Term",
        "TickValue",
        "TradeMultiplier",
        "UnderlylingBMSAssetID",
        "UnderlyingInstrumentId",
        "UnderlyingInstrumentIdentifier",
        "UnderRegulation",
        "VolumeWeightedAvgPrice",
        "VotingRights",
        "WAM",
        "WhenIssued",
        "YieldToMaturity",
        "YieldToWorst",
        "CountryIncorporation",
        "SeniortyType",
        "JPMCSourceID",
        "EffectiveDuration",
        "OPICSSourceID",
        "TradeMultiplierReuters",
        "ContractSizeReuters",
        "FireFlyRootRic",
        "FireFlyExpiryDate",
        "FireFlyTradingCal",
        "NTPACode",
        "FuturesCategory",
        "CRIMSSourceID",
        "CarmignacSourceID",
        "MDSCalendarName",
        "Alpha",
        "AssetPrice",
        "BBGGlobal",
        "BeamsHybridId",
        "Beta",
        "BusinessDayOffSet",
        "Comments",
        "ContinuouslyCallable",
        "Country",
        "CountryCustomer",
        "CouponCurrency",
        "CouponFirstType",
        "CouponPayinKind",
        "CreditTicker",
        "CrossCurrency",
        "CSHeldFund",
        "DividedFreqID",
        "EPS",
        "Eqy_Init_Po_Date",
        "FAbsAvgCoupon",
        "FAbsCPRLifeRate",
        "FAbsDealName",
        "FAbsDelayDays",
        "FAbsLifeCap",
        "FAbsLifeFloor",
        "FAbsOrigMaturityTerm",
        "FAbsPaymentType",
        "FAbsPoolNum",
        "FAbsPSALifeRate",
        "FAbsTBA",
        "FAbsTotalDealAmt",
        "Factored",
        "FCouponNextResetDateBBG",
        "FCouponPaymentDateBBG",
        "FCouponRateBBG",
        "FCouponRateEffectiveDate",
        "FCouponResetFormula",
        "FCouponStepUp",
        "FIAccAccuralWithInterest",
        "FIAccrualBusinessDay",
        "FIAccrualSuppress",
        "FIAccrualThroughSettle",
        "FICouponCalendar",
        "FIDelayDays",
        "FIGenerateSchedule",
        "FIIndesPriceOnIssue",
        "FIIndexAdjust",
        "FIIntersteOnly",
        "FIIntervalDays",
        "FinalValuationDate",
        "FinancingSide",
        "FloatRateResetLagdays",
        "FloatRateSpreadBPS",
        "FwdCommodity",
        "FXDelta",
        "IncomeCurrency",
        "InstrumentTypeTier4",
        "ThirteenF",
        "ThirteengEligible",
        "PershingSourceID",
        "InvestmentCode",
        "InvestmentType",
        "IRDelta",
        "IsDividend",
        "IsHardBorrow",
        "IsNetRule",
        "IsOnFuture",
        "IssuePar",
        "IssueSettleDate",
        "IssueStatus",
        "IssuseAnnounceDate",
        "IsTermLoan",
        "LastSplitDate",
        "LowerBarrier",
        "MarginBBG",
        "MediumTermNotes",
        "MinCallNotificationDays",
        "NetRule",
        "NextCouponDate",
        "NextDivAmount",
        "NextDivDate",
        "NonConduit",
        "Notional",
        "OPT_DELTA",
        "OPT_GAMMA",
        "OPT_RHO",
        "OPT_THETA",
        "OPT_VEGA",
        "OrigDiscount",
        "origexchangeid",
        "OriginalCurrency",
        "OutStandingDate",
        "PaladyneChangeDate",
        "PaladyneCreateDate",
        "PaladyneIntraDayPrice",
        "PaladyneUpdateBy",
        "PalTradingStatus",
        "PartlyPaid",
        "PayFrequency",
        "Perpetual",
        "Pipe",
        "Prefered",
        "PreRefundedDate",
        "PreRefundedPrice",
        "PriceClean",
        "PriceCurrency",
        "PriceRange",
        "PricingFrequency",
        "PrimeCashIDCPricingFlag",
        "RebateAmt",
        "RecoveryRate",
        "RecvCountry",
        "RecvCOUPONDAYCOUNT",
        "RecvCouponFrequency",
        "RecvCouponRate",
        "RecvCurrency",
        "RecvFCouponBaseSecurity",
        "RecvFinancingSide",
        "RecvFloatRateSpreadBPS",
        "RecvNotional",
        "RedemValue",
        "REDID",
        "RFC",
        "RiskCurrency",
        "RiskFactor",
        "SettelmentDays",
        "SharesOutDate",
        "Sink",
        "Symbol",
        "Tenor",
        "TotalAmount",
        "TradeCurrency",
        "TriggerValue",
        "UltimateIssuer",
        "UltimateIssuerCode",
        "UnderlyingAccountId",
        "UnderlylingVirtusID",
        "VirtusAssetDescription",
        "VirtusAssetTrancheID",
        "VirtusBankDealAgentBankID",
        "VirtusBankDealID",
        "VirtusBankDealPrimarySponsorID",
        "VirtusID",
        "VirtusIssuerID",
        "VirtusIssuerName",
        "VirtusLeadUnderwriterID",
        "Volatility",
        "DebtType",
        "Strike",
        "Basket",
        "MinFeeFlag",
        "BreakClauseInd",
        "GICSCode",
        "GICSSector",
        "GICSindustryGroup",
        "GICSIndustry",
        "GICSSubIndustry",
        "TypeTier1Name",
        "TypeTier2Name",
        "TypeTier3Name",
        "SourceName",
        "GuarantorID",
        "CurrentGlobalFacilityAmt",
        "MacaulayDuration",
        "SSCIssuerName",
        "SSCIssuerID",
        "AssetDescription",
        "CoInvestment",
        "TaxableMunicipalSecurities",
        "BBGInversefloaters",
        "BBGMortgageTrancheType",
        "BBGLoanTrancheSize",
        "BBGLoanDealAmount",
        "BBGLoanPurposeDescription",
        "BBGCouponFrequency",
        "BBGLoanCurrentMargin",
        "BBGLIBORFloor",
        "BBGSPRecoveryRating",
        "BBGMoodyOutlook",
        "BBGMoodyWatch",
        "PrincipalPlaceOfBusiness",
        "IsPublicEquity",
        "IsFinancialSponsor",
        "FinancialSponsor2",
        "RestructureClassification",
        "IsMaintenanceCovenants",
        "IsPariPassuDebt",
        "IsCrossDefaultProvision",
        "IsNonCLOCovLite",
        "IsCLOCovLite",
        "LeaseTransactionEurope",
        "IsPIK",
        "ToggleOption",
        "MoodysIndustryCLO20",
        "SandPIndustryCLO20",
        "SandPIndustryCLO2016",
        "CoBorrower",
        "IsFungibleIFIncremental",
        "OID",
        "IsCSPartyToCA",
        "UnderwritersOrArrangers",
        "AmendmentDate",
        "SecondaryAnalyst",
        "AnalystIndustry",
        "SICIndustry",
        "TotalVotingShareValue",
        "SpecialSituationsCompany",
        "CashEquivalent",
        "YieldToCallFlag",
        "BearerIndicator",
        "BBGCovenantLite",
        "BBGBidWorkoutDate",
        "BBGBidYieldToConvention",
        "SpreadToWorst",
        "MacaulayDurationASK",
        "ModifiedDurationASK",
        "EffectiveDurationASK",
        "IsCSanUnderwriter",
        "CouponFrequencyText",
        "FCouponFrequencyText",
        "CouponTypeText",
        "DataProviderId"
      ]
    }

    date {
      match => [ "AddedDate", "ISO8601" ]
      target => "DiscriminatorDate"
    }

    mutate {
      add_field => {
        "url" => "/Instrument/%{InstrumentId}"
      }
    }
  }

  if [type] == "position" {
    csv {
      skip_header => true
      columns => [
        "UniqueId",
        "ROWNUM",
        "AccountID",
        "InstrumentID",
        "TimeID",
        "NetQuantity",
        "MarketPriceLocal",
        "MarketPriceBook",
        "MarketValueBook",
        "MarketValueLocal",
        "LocalCurrency",
        "BookCurrency",
        "CostLocal",
        "CostBook",
        "AccruedInterestBook",
        "AccruedInterestLocal",
        "UnitCostLocal",
        "UnitCostBook",
        "PercentAssets",
        "CouponAmount",
        "Dividend",
        "TotalPL",
        "LongShortPosition",
        "CurrentValueBook",
        "UnsupervisedFlag",
        "YieldOnCost",
        "YieldToMaturity",
        "YieldToCall",
        "YieldToWorst",
        "EstimatedAnnualIncome",
        "AccrualDays",
        "OriginalFace",
        "CurrentFace",
        "Factor",
        "NetSharePosition",
        "SharesonLoan",
        "ExchangeRate",
        "ModifiedDuration",
        "MacaulayDuration",
        "ModifiedDurationToWorst",
        "MacaulayDurationToWorst",
        "BusinessDate",
        "UnrealizedFXGainLoss",
        "UnrealizedPriceGainLoss",
        "RealizedFXGainLoss",
        "RealizedPriceGainLoss",
        "MTDUnrealizedFXGainLoss",
        "MTDUnrealizedPriceGainLoss",
        "MTDRealizedFXGainLoss",
        "MTDRealizedPriceGainLoss",
        "MTDDividend",
        "MTDCoupon",
        "MTDTotalPL",
        "YTDUnrealizedFXGainLoss",
        "YTDUnrealizedPriceGainLoss",
        "YTDRealizedFXGainLoss",
        "YTDRealizedPriceGainLoss",
        "YTDDividend",
        "YTDCoupon",
        "YTDTotalPL",
        "RealizedGainLossShortTerm",
        "RealizedGainLossLongTerm",
        "NetQuantitySettle",
        "MarketValueBookSettle",
        "MarketValueLocalSettle",
        "CostLocalSettle",
        "CostBookSettle",
        "AccruedInterestBookSettle",
        "AccruedInterestLocalSettle",
        "UnrealizedFXGainLossSettle",
        "UnrealizedPriceGainLossSettle",
        "RealizedFXGainLossSettle",
        "RealizedPriceGainLossSettle",
        "PercentAssetsSettle",
        "CouponAmountSettle",
        "DividendSettle",
        "TotalPLSettle",
        "CurrentValueBookSettle",
        "EstimatedAnnualIncomeSettle",
        "MTDUnrealizedFXGainLossSettle",
        "MTDUnrealizedPriceGainLossSettle",
        "MTDRealizedFXGainLossSettle",
        "MTDRealizedPriceGainLossSettle",
        "MTDDividendSettle",
        "MTDCouponSettle",
        "MTDTotalPLSettle",
        "YTDUnrealizedFXGainLossSettle",
        "YTDUnrealizedPriceGainLossSettle",
        "YTDRealizedFXGainLossSettle",
        "YTDRealizedPriceGainLossSettle",
        "YTDDividendSettle",
        "YTDCouponSettle",
        "YTDTotalPLSettle",
        "RealizedGainLossShortTermSettle",
        "RealizedGainLossLongTermSettle",
        "OriginalFaceSettle",
        "NetSharePositionSettle",
        "SharesonLoanSettle",
        "MTDRealizedPriceGainLossShortTerm",
        "MTDRealizedPriceGainLossLongTerm",
        "YTDRealizedPriceGainLossShortTerm",
        "YTDRealizedPriceGainLossLongTerm",
        "DataProviderId",
        "AddedBy",
        "AddedDate",
        "UpdatedBy",
        "UpdatedDate",
        "AuditKey",
        "MTDRealizedPriceGainLossShortTermSettle",
        "MTDRealizedPriceGainLossLongTermSettle",
        "QTDRealizedPriceGainLossShortTermSettle",
        "QTDRealizedPriceGainLossLongTermSettle",
        "YTDRealizedPriceGainLossShortTermSettle",
        "YTDRealizedPriceGainLossLongTermSettle",
        "QTDRealizedPriceGainLossShortTerm",
        "QTDRealizedPriceGainLossLongTerm",
        "ExposureLocal",
        "ExposureBook",
        "BasketID",
        "FwdTransID",
        "PledgedReasonCode",
        "FinancingAccrual",
        "TotalTransferAmount",
        "StrategyCode",
        "DTDTotalPL",
        "UnrealizedPriceGainLossLocal",
        "DTDAccruedInterestLocal",
        "DTDAccruedInterestBook",
        "CreditFacilityFunded",
        "CreditFacilityUnFunded",
        "ParAmount",
        "OutstandingAmount",
        "LoanAmount",
        "VirtusID",
        "SwapInstrumentID",
        "BMSAssetID",
        "MaturityDate",
        "MoodysIndustry",
        "SPIndustry",
        "SnPRecoveryRatingNumerical",
        "WARF",
        "SnPAssetRecovery",
        "MoodysAssetRecovery",
        "SwapEffectiveDate",
        "UnderlyingAccountID",
        "LastSubscriptionDate",
        "PositionClosingMarketValue",
        "PositionPriceDate",
        "MVofTDPosition",
        "LocalCustomMV",
        "BookCustomMV",
        "CostNotional",
        "Fed_Requirement",
        "Pershing_Margin_Requirement",
        "CashShortMargin",
        "CashPhys",
        "PaymentCCY",
        "PaymentDate",
        "SwapNotional",
        "SwapCostNotional",
        "FromCurrency",
        "ToCurrency",
        "SwapOriginalTradeDate",
        "SwapDataProviderInstrumentID",
        "CustodianAccount",
        "CRDFwdTransID",
        "BusinessUnitName",
        "CashPosition",
        "PositionType",
        "DataProviderName",
        "SourceName",
        "NDFFlag",
        "FixingDate",
        "TotalPLLocal",
        "AmortizedCost",
        "SODLocateCost",
        "RDSExtInstrumentId",
        "RDSSourceName",
        "RDSAccountID",
        "BookToUSDExchangeRate",
        "ContractSize",
        "CustodianName",
        "DailyGrossTotalReturnBook",
        "DailyGrossTotalReturnLocal",
        "DailyNetRealizedPL",
        "DailyP&Loverwrite",
        "DailyPriceReturnBook",
        "DailyPriceReturnLocal",
        "DailyRealizedPL",
        "DailyUnrealizedPL",
        "RDSFromCurrency",
        "InterestRateReturnGross",
        "InterestRateReturnGrossDTD",
        "InterestRateReturnWeighted",
        "IsSMPFund",
        "LocalEndMarketPrice",
        "LtdRealized",
        "LtdRealizedPL",
        "LtdTotalPL",
        "LtdUnrealized",
        "LtdUnrealizedPL",
        "LtdUnrealizedPLSettled",
        "LtdUnrealizedPLTraded",
        "MarketExposureGross",
        "MtdRealized",
        "MtdRealizedPL",
        "MTDTotalFXPL",
        "MtdUnrealized",
        "MtdUnrealizedPL",
        "Multiplier",
        "Notional",
        "NotionalBook",
        "OpeningMarketPrice",
        "OpeningMarketValue",
        "SourcePositionId",
        "StrategyName",
        "SubEntity",
        "SubStrategyName",
        "UnrealizedPL",
        "VolumeTurnOver",
        "Weight",
        "YTDAccruedInterest",
        "YtdRealized",
        "YtdRealizedFX",
        "YtdRealizedPL",
        "YtdUnrealized",
        "YtdUnRealizedFX",
        "YtdUnrealizedPL",
        "RDSBookCurrency",
        "RDSBasketID",
        "RDSInstrumentId",
        "InstrumentTicker",
        "InstrumentRIC",
        "InstrumentSedol",
        "InstrumentCusip",
        "InstrumentIsin",
        "TypeTier1Name",
        "TypeTier2Name",
        "TypeTier3Name",
        "CRDAISourceID",
        "SSNCSourceID",
        "CitiSourceID",
        "BMSSourceID",
        "BNPSourceID",
        "CRDSMGSourceID",
        "CitcoSourceID",
        "SEISourceID",
        "PalSourceID",
        "JPMCSourceID",
        "CRIMSSourceID",
        "CarmignacSourceID",
        "GICSCode",
        "GICSSector",
        "GICSIndustryGroup",
        "GICSIndustry",
        "GICSSubIndustry",
        "PortfolioName",
        "AccountName",
        "AccountCurrencyId",
        "ManagerName",
        "AccountCustodianName"
      ]
    }

    date {
      match => [ "BusinessDate", "ISO8601" ]
      target => "DiscriminatorDate"
    }

    mutate {
      add_field => {
        "url" => "/Position/%{UniqueId}"
      }
      rename => { "DailyP&Loverwrite" => "DailyPLoverwrite" }
    }
  }

  ruby {
    init => "require 'time'"
    code => "
        diff = Time.now().to_i - event.get('DiscriminatorDate').to_i
        olderThanYear = diff > 183 * 24 * 3600
        event.set('hive', olderThanYear ? 'true' : 'false')
        event.remove('host')
        event.remove('path')
        event.remove('message')
        event.remove('DiscriminatorDate')
        event.remove('@version')
        event.remove('@timestamp')
      "
  }
}

output {
  kafka {
    bootstrap_servers => "kafka.local:9092"
    topic_id => "%{type}"
    codec => json
  }
}
